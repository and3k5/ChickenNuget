@using ChickenNuget.Data
@{
    ViewData["Title"] = "Home Page";
}

@if (ViewBag.HasConfig == false)
{
    <div class="jumbotron">
        <h1>Config missing</h1>
        <p class="lead">Configuration is not found</p>
        <p class="lead">
            <a class="btn btn-primary btn-lg" href="@Url.Action("Configuration")" role="button">Create a new config</a>
        </p>
    </div>
}
else
{
    var nugetOverview = (Dictionary<IProjectReference, IProjectFile[]>) ViewBag.NugetOverview;
    
    <div class="row">
        <div class="col-lg-12">
            <h2>Nuget overview</h2>
            <div>
                <p>Connection: @ViewBag.ConnectionName</p>
                <p>Source: @ViewBag.ConnectionType</p>
            </div>
            <table class="table table-striped table-bordered">
                @foreach (var project in nugetOverview)
                {
                    foreach (var file in project.Value)
                    {
                        <tr>
                            @if (Array.IndexOf(project.Value,file) == 0)
                            {
                                <td rowspan="@project.Value.Length">@project.Key.GetName()</td>
                            }
                            <td>@file.FilePath()</td>
                        </tr>
                    }
                }
            </table>
        </div>
    </div>
}


